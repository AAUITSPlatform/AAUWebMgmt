@model ITSWebMgmt.Models.WindowsComputerModel
@using System.Web;

<table class="ui definition table">
    <tbody>
        <tr>
            <td>Domain:</td>
            <td>
                @Html.DisplayFor(model => model.Domain)
            </td>
        </tr>
        <tr>
            <td>Admin Pwd Expire:</td>
            <td>
                @Html.DisplayFor(model => model.PasswordExpireDate)
            </td>
        </tr>
        <tr>
            <td>PC Config:</td>
            <td>
                @Html.DisplayFor(model => model.ConfigPC)
            </td>
        </tr>
        <tr>
            <td>Bitlocker Enabled:</td>
            <td>
                @Html.DisplayFor(model => model.ConfigExtra)
            </td>
        </tr>
        <tr>
            @Html.Partial("ManagedBy", Model.ManagedBy)
        </tr>
        <tr>
            <td>Using OneDrive:</td>
            <td>
                @Html.Raw(Model.UsesOnedrive)
            </td>
        </tr>
    </tbody>
</table>
<br />
<div id="password">
    <code id="passwordResponseDiv"></code>
    <p style="display:none" id="passwordExpirationNotice"><br />Password will expire in 8 hours.</p>
</div>
<div id="passworddiv">
    @if (Model.ShowResultGetPassword)
    {
        <button id="btnPassword">Get Local Admin Password</button>
    }
</div>
<script>
    $("#btnPassword").click(function ()
    {
        getPassword('');
    });
    function getPassword(buttonNumber)
    {
        var computername = '@Html.Raw(HttpUtility.JavaScriptStringEncode(Model.ComputerName))';
        $.ajax({
            type: "POST",
            url: '@Url.Action("ResultGetPassword", "Computer")',
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(computername),
            dataType: "json",
            success: function (response) {
                document.getElementById('passworddiv' + buttonNumber).style.display = "none";
                document.getElementById('passwordResponseDiv' + buttonNumber).innerHTML = response.message;
                document.getElementById('passwordExpirationNotice' + buttonNumber).style.display = "inline";
            },
            error: function (response) {
                var r = JSON.parse(response.responseText);
                document.getElementById('passworddiv' + buttonNumber).style.display = "none";
                document.getElementById('passwordResponseDiv' + buttonNumber).innerHTML = r.errorMessage;
            }
        });
    }
</script>